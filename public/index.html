<!--
    HTML5 Robot User Interface Web Application
    An ASLab Project,
    Developed by Daniel Peiró
    ETSII, UPM 2014-2015
-->
<!DOCTYPE html>
<html data-ng-app="HRUI" data-ng-controller="HRUIController">

<head>
    <title>HRUI</title>
    <meta charset="UTF-8">
    <meta name="description" content="HTML5 Robot User Interface">
    <meta name="author" content="Daniel Peiró">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/style.css">
</head>

<body>
    <div id="body">
        <div id="toolbar" class="frame">
            <span>
                <input id="joystickCheckbox" type="checkbox" data-ng-model="joystickOn" data-ng-click="updateControls($event, joystickOn)">
                <label for="joystickCheckbox">Joystick {{ joystickOn | OnOff}}</label>
                <input id="dataMonitorCheckbox" type="checkbox" data-ng-model="dataMonitorOn" data-ng-click="updateControls($event, dataMonitorOn)">
                <label for="dataMonitorCheckbox">Data Monitor {{ dataMonitorOn | OnOff}}</label>
            </span>
            <span>
                <input id="customDataCheckbox" type="checkbox" data-ng-model="customDataOn" data-ng-click="updateControls($event, customDataOn)">
                <label for="customDataCheckbox">Custom Data {{ customDataOn | OnOff}}</label>
                <input id="customInputCheckbox" type="checkbox" data-ng-model="customInputOn" data-ng-click="updateControls($event, customInputOn)">
                <label for="customInputCheckbox">Custom Input {{ customInputOn | OnOff}}</label>
            </span>
            <span>
                <input id="liveVideoCheckbox" type="checkbox" data-ng-model="liveVideoOn" data-ng-click="updateControls($event, liveVideoOn)">
                <label for="liveVideoCheckbox">Live Video {{ liveVideoOn | OnOff}}</label>
                <input id="liveAudioCheckbox" type="checkbox" data-ng-model="liveAudioOn" data-ng-click="updateControls($event, liveAudioOn)">
                <label for="liveAudioCheckbox">Live Audio {{ liveAudioOn | OnOff}}</label>
            </span>
            <span>
                <input id="geolocationCheckbox" type="checkbox" data-ng-model="geolocationOn" data-ng-click="updateControls($event, geolocationOn)">
                <label for="geolocationCheckbox">Geolocation {{ geolocationOn | OnOff}}</label>
                <input id="scriptExecCheckbox" type="checkbox" data-ng-model="scriptExecOn" data-ng-click="updateControls($event, scriptExecOn)">
                <label for="scriptExecCheckbox">Run Scripts {{ scriptExecOn | OnOff}}</label>                
            </span>
            <select id="profilesList" class="profileSection" data-ng-model="selectedProfile" data-ng-options="value.name for (profile, value) in profiles" data-ng-change="profileSelected()">
                <option value="" disabled selected>Load Profile...</option>
            </select>
            <button id="saveProfile" class="profileSection" data-ng-click="saveProfileClicked=true" data-ng-show="!saveProfileClicked">Save Current Profile</button>
            <form data-ng-submit="saveProfile()" class="profileSection">
                <input id="profileNameText" type="text" data-ng-show="saveProfileClicked" data-ng-model="profileName" required>
                <button id="saveProfileNow" type="submit" data-ng-show="saveProfileClicked">Save</button>
            </form>
        </div>
        <br>
        <div id="videoFrame" class="frame" data-ng-controller="LiveVideoController" data-ng-if="liveVideoOn">
            <canvas id="videoCanvas" class="canvas">
                Canvas not supported
            </canvas>
            <br>
            <label for="videoDevice">Video Device:</label>
            <input id="videoDevice" type="number" data-ng-model="videoDevice" data-ng-change="videoDeviceSelected(videoDevice)" min="0">
        </div>
        <div id="geolocationFrame" class="frame" data-ng-controller="GeolocationController" data-ng-if="geolocationOn"></div>
        <div id="audioFrame" class="frame" data-ng-controller="LiveAudioController" data-ng-if="liveAudioOn">
            <h5>Note: Experimental Feature. Audio has a delay of approx. 2 seconds</h5></div>
        <div id="joystickFrame" class="frame" data-ng-controller="JoystickController" data-ng-if="joystickOn">
            <canvas id="joystick" class="canvas" data-touch>
                Canvas not supported
            </canvas>
            <canvas id="vector" class="canvas" data-ng-show="showVector">
                Canvas not supported
            </canvas>
            <br>
            <span class="coord">X:{{point.x.toFixed(2)}} Y:{{point.y.toFixed(2)}}</span>
            <br>
            <form class="form">
                <table>
                    <tr>
                        <td>
                            <input name="Lock Mode" type="radio" data-ng-model="lockMode" data-value="fullAnalog">Full Analog
                        </td>
                        <td>
                            <input name="Lock Mode" type="radio" data-ng-model="lockMode" data-value="lock8ways">8-Way
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input name="Lock Mode" type="radio" data-ng-model="lockMode" data-value="lock4ways">4-Way
                        </td>
                        <td>
                            <input name="Lock Mode" type="radio" data-ng-model="lockMode" data-value="lock2ways">2-Way
                        </td>
                    </tr>
                </table>
                <input name="Lock Joystick" type="checkbox" data-ng-model="lockJoystick" data-ng-change="resetAll()"> Lock Joystick in Position
                <br>
                <input name="Display Vector" type="checkbox" data-ng-model="showVector"> Display Vector
                <br>
            </form>
        </div>
        <div id="dataFrame" class="frame" data-ng-controller="DataController" data-ng-if="dataMonitorOn">
            <canvas id="mapcanvas" class="canvas"></canvas>
            <table id="dataTable" class="table">
                <tr class="smalltext">
                    <th>Position</th>
                    <th>Orientation</th>
                    <th>Speed</th>
                    <th>Angular Speed</th>
                </tr>
                <tr>
                    <td>x: {{position.x.toFixed(3)}}</td>
                    <td>&alpha;: {{orientation.alpha.toFixed(3)}}</td>
                    <td>v<sub>x</sub>: {{speed.vx.toFixed(3)}}</td>
                    <td>&alpha;&#775;: {{angularSpeed.dAlpha.toFixed(3)}}</td>
                </tr>
                <tr>
                    <td>y: {{position.y.toFixed(3)}}</td>
                    <td>&beta;: {{orientation.beta.toFixed(3)}}</td>
                    <td>v<sub>y</sub>: {{speed.vy.toFixed(3)}}</td>
                    <td>&beta;&#775;: {{angularSpeed.dBeta.toFixed(3)}}</td>
                </tr>
                <tr>
                    <td>z: {{position.z.toFixed(3)}}</td>
                    <td>&gamma;: {{orientation.gamma.toFixed(3)}}</td>
                    <td>v<sub>z</sub>: {{speed.vz.toFixed(3)}}</td>
                    <td>&gamma;&#775;: {{angularSpeed.dGamma.toFixed(3)}}</td>
                </tr>
            </table>
            <label for="mapscale">Map Scale:</label>
            <input id="mapscale" type="number" data-ng-model="scale">
        </div>
        <div id="customDataFrame" class="frame" data-ng-controller="CustomDataController" data-ng-if="customDataOn">
            <form id="customDataForm" class="form" data-ng-if="!customDataFormSubmitted">
                Item Name:
                <input type="text" data-ng-model="customDataRequest.item">
                <br> Update interval (ms):
                <input type="number" data-ng-model="customDataRequest.updateInterval">
                <br>
                <input type="submit" value="Submit" data-ng-click="customDataFormSubmit()">
            </form>
            <span data-ng-if="customDataFormSubmitted">
                Requested item: {{customDataRequest.item}}
                <br> Requested interval: {{customDataRequest.updateInterval}}ms (rounded to 100ms)
                <br>
                </span>
            <table id="customDataTable" class="table" data-ng-bind-html="customDataTable" data-ng-if="customDataFormSubmitted"></table>
        </div>
        <div id="customInputFrame" class="frame" data-ng-controller="CustomInputController" data-ng-if="customInputOn">
            <form id="customInputSelectionForm" class="form" data-ng-if="!customInputSelectionSubmitted" data-ng-submit="customInputSelectionSubmit()">
                Item Name:
                <input type="text" data-ng-model="customInputRequest.item" required>
                <br> Number of Inputs:
                <input type="number" data-ng-model="customInputRequest.numberOfInputs" min="1" max="50" required>
                <br>
                <input type="submit" value="Submit">
            </form>
            <form id="customInputForm" data-ng-if="customInputSelectionSubmitted && !customInputFormSubmitted" data-ng-submit="customInputFormSubmit()">
                Input item: {{customInputRequest.item}}
                <br>
                <p data-ng-if="customInputSelectionSubmitted" data-ng-repeat="input in customInputList">Input {{$index+1}} Name:
                    <input type="text" data-ng-model="input.name" data-ng-pattern="/^[a-zA-Z0-9-_]*$/" required> Type:
                    <select data-ng-model="input.type" required>
                        <option value="">Select...</option>
                        <option value="text">Text</option>
                        <option value="range">Slider</option>
                        <option value="number">Number</option>
                        <option value="checkbox">Checkbox</option>
                    </select>
                    <span data-ng-if="input.type=='range' || input.type=='number'">
                        Min:<input type="number" data-ng-model="input.min" data-ng-required="input.type=='range'">
                        Max:<input type="number" data-ng-model="input.max" data-ng-required="input.type=='range'">
                    </span>
                </p>
                <input type="submit" value="Submit">
                <span class="smalltext" data-ng-show="!dataIsValid">Valid Names: Start with letter or _. No Symbols (except _) or Spaces. Unique; Ranges Min &lt; Max.</span>
            </form>
            <span data-ng-if="customInputFormSubmitted">
                Input item: {{customInputRequest.item}}
                <br>
            </span>
            <table id="customInputTable" class="table" data-compile="customInputTable" data-ng-if="customInputFormSubmitted"></table>
            <span data-ng-show="customInputFormSubmitted">
            <input id="autoUpdate" type="checkbox" data-ng-model="autoUpdateOn" >Auto Send All on change {{ autoUpdateOn | OnOff}}
            <br>
            <button data-ng-click="inputChanged($event)">Send Input</button>
            </span>
        </div>
        <div id="scriptExecFrame" class="frame" data-ng-controller="ScriptExecController" data-ng-if="scriptExecOn">
            <table>
                <tr>
                    <th>Name</th>
                    <th>Status</th>
                </tr>
                <tr data-ng-repeat="script in scripts">
                    <td>{{script.name}}</td>
                    <td class="tdimg"><img data-ng-src="images/{{script.status}}.svg" width="12px" height="12px">
                    </td>
                    <td>
                        <button data-ng-click="runScript(script)" data-ng-show="script.showRun">Run </button>
                        <button data-ng-click="killScript(script)" data-ng-show="!script.showRun">Kill</button>
                    </td>
                </tr>
            </table>
            <span class="smalltext"><img data-ng-src="images/standby.svg" width="12px" height="12px"> Standby</span>
            <span class="smalltext"><img data-ng-src="images/running.svg" width="12px" height="12px"> Running</span>
            <span class="smalltext"><img data-ng-src="images/killed.svg" width="12px" height="12px"> Not Running</span>
            <br>
            <span class="smalltext">Deactivating 'Run Scripts' will kill all running scripts.</span>
            <br>
            <span class="smalltext">Streams Update on script exit (or buffer size exceded)</span>
            <br>
            <input id="stdoutCheckbox" type="checkbox" data-ng-model="stdoutOn">
            <label for="stdoutCheckbox">Show stdout</label>
            <input id="stderrCheckbox" type="checkbox" data-ng-model="stderrOn">
            <label for="stderrCheckbox">Show stderr</label>
            <p>
                <textarea id="stdout" class="smalltext" data-ng-show="stdoutOn" data-ng-model="stdout" readonly></textarea>
                <textarea id="stderr" class="smalltext" data-ng-show="stderrOn" data-ng-model="stderr" readonly></textarea>
            </p>
        </div>
        <footer class="footer">
            <h6>
            <a href="http://www.aslab.upm.es"> <img src="images/aslablogo.png" width="64" height="64" alt="ASLab" title="ASLab Logo" ></a>
            <img src="images/HTML5Logo.svg" width="64" height="64" alt="HTML5" title="HTML5 Logo"><br>            
            <a href="http://github.com/xpeiro/HTML5RUI"><img src="images/githublogo.svg" width="24" height="24"></a>
            An ASLab Project Developed By Daniel Peiró (using 
            <a href="https://github.com/audiocogs/aurora.js">Aurora</a>, <a href="https://github.com/fsbdev/aurora-websocket">Aurora-WebSocket</a>, and 
            <a href="https://github.com/phoboslab/jsmpeg">JSmpeg</a> under MIT License)
            </h6>
        </footer>
        <script type="text/javascript" src="javascripts/socket.io/socket.io.min.js"></script>
        <script type="text/javascript" src="javascripts/angular/angular.min.js"></script>
        <script type="text/javascript" src="javascripts/angular/angular-sanitize.min.js"></script>
        <script type="text/javascript" src="javascripts/hrui/angularapp.js"></script>
        <script type="text/javascript" src="javascripts/hrui/angularservices.js"></script>
        <script data-ng-if="joystickOn" type="text/javascript" src="javascripts/hrui/joystick.js"></script>
        <script data-ng-if="dataMonitorOn" type="text/javascript" src="javascripts/hrui/datamonitor.js"></script>
        <!-- jsmpeg by Dominic Szablewski - phoboslab.org, github.com/phoboslab -->
        <script data-ng-if="liveVideoOn" type="text/javascript" src="javascripts/jsmpeg/jsmpg.min.js"></script>
        <script data-ng-if="liveVideoOn" type="text/javascript" src="javascripts/hrui/livevideo.js"></script>
        <script data-ng-if="geolocationOn" type="text/javascript" src="http://maps.googleapis.com/maps/api/js?">
        </script>
        <script data-ng-if="geolocationOn" type="text/javascript" src="javascripts/hrui/geolocation.js"></script>
        <script data-ng-if="customDataOn" type="text/javascript" src="javascripts/hrui/customdata.js"></script>
        <script data-ng-if="customInputOn" type="text/javascript" src="javascripts/hrui/custominput.js"></script>
        <script data-ng-if="sshClientOn" type="text/javascript" src="javascripts/hrui/scriptexec.js"></script>
        <!--Aurora.js and Flac.js by Audiocogs: http://audiocogs.org/ -->
        <script data-ng-if="liveAudioOn" type="text/javascript" src="javascripts/aurora/aurora.js"></script>
        <script data-ng-if="liveAudioOn" type="text/javascript" src="javascripts/aurora/mp3.js"></script>
        <!--Aurora.js Websocket Plugin by fsbdev: https://github.com/fsbdev/aurora-websocket -->
        <script data-ng-if="liveAudioOn" type="text/javascript" src="javascripts/aurora/aurora-websocket.js"></script>
        <script data-ng-if="liveAudioOn" type="text/javascript" src="javascripts/hrui/liveaudio.js"></script>
    </div>
</body>

</html>
<!--
jsmpg.js , aurora.js, aurora-websockets.js, flac.js all used under MIT License:

jsmpeg.js Copyright (c) 2014 Dominic Szablewski http://www.phoboslab.org/
aurora.js, flac.js Copyright (c) 2014 http://audiocogs.org/
aurora-websockets.js Copyright (c) 2014 fabienbrooke@gmail.com

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
-->
